version: "3.1"
stories:
- story: bot challenge (./tests/test_stories.yml)
  steps:
  - intent: bot_challenge
  - action: utter_iamabot  # predicted: utter_bot_challenge/bot
- story: Test user affirms to check restaurant after logging in (./tests/test_stories.yml)
  steps:
  - intent: greet
  - action: action_utter_greet_and_intro
  - action: action_ask_language_preference
  - intent: inform_permanent_language
  - slot_was_set:
    - permanent_language: en
  - action: action_set_permanent_language
  - action: action_utter_wanna_book
  - intent: affirm
  - action: action_ask_registered_and_show_login_signup_quick_replies
  - intent: request_login_form
  - action: login_form
  - active_loop: login_form
  - slot_was_set:
    - user_email: kalpa@gmail.com
  - slot_was_set:
    - user_password: pass
  - active_loop: null
  - action: action_login_user
  - slot_was_set:
    - is_authenticated: true
  - action: action_listen  # predicted: action_show_cuisines
  - intent: request_restaurants
  - slot_was_set:
    - cuisine: null
  - action: action_show_cuisines  # predicted: action_unlikely_intent
  - intent: inform_cuisine
  - slot_was_set:
    - cuisine: italian
  - action: action_show_restaurants  # predicted: action_unlikely_intent
  - intent: inform_booking_restaurant_id
  - slot_was_set:
    - restaurant_id: rid_6431ac87d5f9f6b0be596abb
  - action: action_show_selected_restaurant_ask_booking_confirmation
  - intent: affirm
  - action: restaurant_booking_form
  - active_loop: restaurant_booking_form
  - intent: inform_num_people
    entities:
    - num_people: '2'
  - slot_was_set:
    - num_people: '2'
  - action: action_listen  # predicted: action_deactivate_form
  - intent: inform_date
    entities:
    - date: 2024/01/01
  - slot_was_set:
    - date: 2024/01/01
  - action: restaurant_booking_form  # predicted: action_deactivate_form
  - active_loop: null
  - action: action_show_booking_summary
  - intent: affirm
  - action: action_confirm_booking  # predicted: action_default_fallback after action_unlikely_intent
  - action: action_utter_thank_you
  - action: action_ask_anything_else  # predicted: action_listen
- story: Test user logs in, changes language preference and stops (./tests/test_stories.yml)
  steps:
  - intent: greet
  - action: action_utter_greet_and_intro
  - action: action_ask_language_preference
  - intent: inform_permanent_language
  - slot_was_set:
    - permanent_language: en
  - action: action_set_permanent_language
  - action: action_utter_wanna_book
  - intent: affirm
  - action: action_ask_registered_and_show_login_signup_quick_replies
  - intent: request_login_form
  - action: login_form
  - active_loop: login_form
  - slot_was_set:
    - user_email: example@gmail.com
  - slot_was_set:
    - user_password: pass
  - active_loop: null
  - action: action_login_user
  - slot_was_set:
    - is_authenticated: true
  - action: action_listen  # predicted: action_show_cuisines
  - intent: inform_permanent_language
  - slot_was_set:
    - permanent_language: en
  - action: action_set_permanent_language  # predicted: action_unlikely_intent
  - action: action_listen  # predicted: action_utter_wanna_book
  - intent: stop
  - action: action_clear_restaurant_booking_slots  # predicted: action_unlikely_intent
  - action: action_utter_bye_see_you_later  # predicted: action_utter_thank_you
- story: Test user signs up, makes a booking but changes mind (./tests/test_stories.yml)
  steps:
  - intent: greet
  - action: action_utter_greet_and_intro
  - action: action_ask_language_preference
  - intent: inform_permanent_language
  - slot_was_set:
    - permanent_language: en
  - action: action_set_permanent_language
  - action: action_utter_wanna_book
  - intent: affirm
  - action: action_ask_registered_and_show_login_signup_quick_replies
  - intent: request_signup_form  # predicted: nlu_fallback: /request_signup_form
  - action: registration_form  # predicted: action_ask_registered_and_show_login_signup_quick_replies
  - active_loop: registration_form
  - slot_was_set:
    - user_email: example@gmail.com
  - slot_was_set:
    - user_password: pass
  - active_loop: null
  - action: action_signup_user  # predicted: action_save_user_and_complete_registration
  - slot_was_set:
    - is_authenticated: true
  - intent: request_restaurants
  - slot_was_set:
    - cuisine: null
  - action: action_show_cuisines  # predicted: action_unlikely_intent
  - intent: inform_cuisine
  - slot_was_set:
    - cuisine: italian
  - action: action_show_restaurants  # predicted: action_unlikely_intent
  - intent: inform_booking_restaurant_id
  - slot_was_set:
    - restaurant_id: rid_6431ac87d5f9f6b0be596abb
  - action: action_show_selected_restaurant_ask_booking_confirmation
  - intent: affirm
  - action: restaurant_booking_form
  - active_loop: restaurant_booking_form
  - intent: inform_num_people
    entities:
    - num_people: '4'
  - slot_was_set:
    - num_people: '4'
  - action: action_listen  # predicted: action_deactivate_form
  - intent: inform_date
    entities:
    - date: 2024/01/15
  - slot_was_set:
    - date: 2024/01/15
  - action: restaurant_booking_form  # predicted: action_deactivate_form
  - active_loop: null
  - action: action_show_booking_summary
  - intent: deny
  - action: action_utter_thank_you  # predicted: action_clear_restaurant_booking_slots after action_unlikely_intent
  - action: action_ask_anything_else
- story: Test user changes booking date (./tests/test_stories.yml)
  steps:
  - intent: greet
  - action: action_utter_greet_and_intro
  - action: action_ask_language_preference
  - intent: inform_permanent_language
  - slot_was_set:
    - permanent_language: en
  - action: action_set_permanent_language
  - action: action_utter_wanna_book
  - intent: affirm
  - action: restaurant_booking_form  # predicted: action_ask_registered_and_show_login_signup_quick_replies
  - active_loop: restaurant_booking_form
  - intent: inform_num_people
    entities:
    - num_people: '2'
  - slot_was_set:
    - num_people: '2'
  - intent: inform_date
    entities:
    - date: 2024/02/01
  - slot_was_set:
    - date: 2024/02/01
  - action: restaurant_booking_form  # predicted: action_listen
  - slot_was_set:
    - date: 2024/02/02
  - active_loop: null
  - action: action_show_booking_summary
- story: Test user changes booking num_people (./tests/test_stories.yml)
  steps:
  - intent: greet
  - action: action_utter_greet_and_intro
  - action: action_ask_language_preference
  - intent: inform_permanent_language
  - slot_was_set:
    - permanent_language: en
  - action: action_set_permanent_language
  - action: action_utter_wanna_book
  - intent: affirm
  - action: restaurant_booking_form  # predicted: action_ask_registered_and_show_login_signup_quick_replies
  - active_loop: restaurant_booking_form
  - intent: inform_num_people
    entities:
    - num_people: '2'
  - slot_was_set:
    - num_people: '2'
  - intent: inform_date
    entities:
    - date: 2024/02/01
  - slot_was_set:
    - date: 2024/02/01
  - action: restaurant_booking_form  # predicted: action_listen
  - slot_was_set:
    - num_people: 4
  - active_loop: null
  - action: action_show_booking_summary
- story: Test user changes both booking date and num_people (./tests/test_stories.yml)
  steps:
  - intent: greet
  - action: action_utter_greet_and_intro
  - action: action_ask_language_preference
  - intent: inform_permanent_language
  - slot_was_set:
    - permanent_language: en
  - action: action_set_permanent_language
  - action: action_utter_wanna_book
  - intent: affirm
  - action: restaurant_booking_form  # predicted: action_ask_registered_and_show_login_signup_quick_replies
  - active_loop: restaurant_booking_form
  - intent: inform_num_people
    entities:
    - num_people: '2'
  - slot_was_set:
    - num_people: '2'
  - intent: inform_date
    entities:
    - date: 2024/02/01
  - slot_was_set:
    - date: 2024/02/01
  - action: restaurant_booking_form  # predicted: action_listen
  - slot_was_set:
    - num_people: 4
  - slot_was_set:
    - date: 2024/02/02
  - active_loop: null
  - action: action_show_booking_summary
