version: "3.1" # stories-greeting.yml has greeting and continuation to booking stories for the restaurant bot

stories:

  # -------------------------------- Greet and push towards book restaurant happy path ------------------------------- #
  - story: Greeting and bot introduction with checkpoint #1
    steps:
      - intent: greet
      - action: utter_greet
      - action: utter_bot_intro
      - action: utter_wanna_book
      - checkpoint: checkpoint_wanna_book_restaurant

  - story: User denies to check restaurant #2
    steps:
      - checkpoint: checkpoint_wanna_book_restaurant
      - intent: deny
      - action: utter_thank_you
      - action: action_ask_anything_else

  - story: User affirms to check restaurant - logged in #3
    steps:
      - checkpoint: checkpoint_wanna_book_restaurant
      - intent: affirm # from this point tell user to log or signup
      - action: action_show_cuisines
      - checkpoint: checkpoint_cuisine_selection

  - story: User request restaurant after greet and intro - logged in #4
    steps:
      - checkpoint: checkpoint_wanna_book_restaurant
      - intent: request_restaurants
      - action: action_show_cuisines
      - checkpoint: checkpoint_cuisine_selection

  # use to check if user_id is set or not
  #      - slot_was_set:
  #          - user_id: uid_123

  # Commented below stories for testing above and fix the bugs

  #  - story: User affirms to check restaurant - not logged in #4
  #    steps:
  #      - action: utter_wanna_book
  #      - intent: affirm
  #      - slot_was_set:
  #          - user_id: null
  #      - action: action_ask_registered_and_show_login_signup_quick_replies # continue from #6,7,8
  #
  #  - story: User request restaurant after greet and intro - not logged in #5
  #    steps:
  #      - action: utter_wanna_book
  #      - intent: request_restaurants
  #      - slot_was_set:
  #          - user_id: null
  #      - action: action_ask_registered_and_show_login_signup_quick_replies # continue from #6,7,8
  #
  #  - story: User not logged in - request_login_form ( A registered user ) #6
  #    steps:
  #      - action: action_ask_registered_and_show_login_signup_quick_replies
  #      - intent: request_login_form
  #      - action: login_form
  #      - active_loop: login_form
  #      - active_loop: null
  #      - slot_was_set:
  #          - requested_slot: null
  #      - action: action_login_user
  #      - slot_was_set:
  #          - user_name: null
  #          - user_id: null
  #          - user_email: null
  #      - action: utter_login_success
  #      - action: action_show_cuisines
  #      - intent: inform_cuisine
  #
  #  - story: User not logged in - request_user_registration_form (A New user) #7
  #    steps:
  #      - action: action_ask_registered_and_show_login_signup_quick_replies
  #      - intent: request_user_registration_form
  #      - action: registration_form
  #      - active_loop: registration_form
  #      - active_loop: null
  #      - slot_was_set:
  #          - requested_slot: null
  #      - action: action_save_user_and_complete_registration
  #      - slot_was_set:
  #          - user_name: null
  #          - user_id: null
  #          - user_email: null
  #      - action: action_show_cuisines
  #      - intent: inform_cuisine

#  - story: User not logged in - stop (Unhappy path) #8
#    steps:
#      - action: action_ask_registered_and_show_login_signup_quick_replies
#      - intent: stop
#      - action: utter_bye_see_you_later
