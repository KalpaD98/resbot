version: "3.1"

stories:
  - story: User wants to view bookings (logged in)
    steps:
      - intent: view_bookings
      - slot_was_set:
          - is_authenticated: True
      - action: action_show_booking_view_options

  - story: User wants to view all bookings (logged in)
    steps:
      - intent: view_all_bookings
      - slot_was_set:
          - is_authenticated: True
      - action: action_show_bookings_carousal

  - story: User wants to view upcoming bookings (logged in)
    steps:
      - intent: view_upcoming_bookings
      - slot_was_set:
          - is_authenticated: True
      - action: action_show_future_bookings_carousal

  - story: User wants to view past bookings (logged in)
    steps:
      - intent: view_past_bookings
      - slot_was_set:
          - is_authenticated: True
      - action: action_show_past_bookings_carousal

  - story: User wants to view bookings (not logged in)
    steps:
      - intent: view_bookings
      - slot_was_set:
          - is_authenticated: False
      - action: action_ask_registered_and_show_login_signup_quick_replies
      - action: login_form
      - active_loop: login_form

  - story: Submit login form for bookings
    steps:
      - action: login_form
      - active_loop: null
      - slot_was_set:
          - requested_slot: null
      - action: action_login_user
      - slot_was_set:
          - is_authenticated: True

  - story: Show past bookings after login
    steps:
      - intent: view_past_bookings
      - slot_was_set:
          - is_authenticated: True
      - action: action_show_past_bookings_carousal

  - story: Show upcoming bookings after login
    steps:
      - intent: view_upcoming_bookings
      - slot_was_set:
          - is_authenticated: True
      - action: action_show_future_bookings_carousal

  - story: Show all bookings after login
    steps:
      - intent: view_all_bookings
      - slot_was_set:
          - is_authenticated: True
      - action: action_show_bookings_carousal


#version: "3.1" # stories-view-restaurant-booking.yml has stories for user viewing their bookings
#
## currently only logged in cases are handled
#
#stories:
#  # NOT WORKING PROPERLY - NEED TO CHECK
#  - story: User wants to view bookings (logged in)   # view all bookings
#    steps:
#      - intent: view_bookings
#      - slot_was_set:
#          - is_authenticated: True
#      - action: action_show_booking_view_options
#
#  - story: User wants to view all bookings (logged in)   # view all bookings
#    steps:
#      - intent: view_all_bookings
#      - slot_was_set:
#          - is_authenticated: True
#      - action: action_show_bookings_carousal
#
#  # view upcoming bookings
#  - story: User wants to view upcoming bookings (logged in)
#    steps:
#      - intent: view_upcoming_bookings
#      - slot_was_set:
#          - is_authenticated: True
#      - action: action_show_future_bookings_carousal
#
#  # view past bookings
#  - story: User wants to view past bookings (logged in)
#    steps:
#      - intent: view_past_bookings
#      - slot_was_set:
#          - is_authenticated: True
#      - action: action_show_past_bookings_carousal
#
#  # cases where user is not logged in
#  - story: User wants to view bookings (not logged in)
#    steps:
#      - intent: view_bookings
#      - slot_was_set:
#          - is_authenticated: False
#      - action: action_ask_registered_and_show_login_signup_quick_replies
#      # add a checkpoint for reg or login and move forward | currently only login is handled
#      - action: login_form
#      - active_loop: login_form
#      - checkpoint: login_completed
#
#  - story: Submit login form for bookings # not sure if this is needed because already handled in rules
#    steps:
#      - checkpoint: login_completed
#      - action: login_form
#      - active_loop: null
#      - slot_was_set:
#          - requested_slot: null
#      - action: action_login_user
#      - slot_was_set:
#          - is_authenticated: True
#      - checkpoint: after_login_completed
#
#  - story: Show past bookings after login # issue might be here and in the other stories below
#    steps:
#      - checkpoint: after_login_completed
#      - intent: view_past_bookings
#      - action: action_show_past_bookings_carousal
#
#  - story: Show upcoming bookings after login
#    steps:
#      - checkpoint: after_login_completed
#      - intent: view_upcoming_bookings
#      - action: action_show_future_bookings_carousal
#
#  - story: Show all bookings after login
#    steps:
#      - checkpoint: after_login_completed
#      - intent: view_all_bookings
#      - action: action_show_bookings_carousal